<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>CR Token Control Panel</title>
  <style>
    body {
      background: #0e0e0e;
      color: #00ffee;
      font-family: monospace;
      text-align: center;
      padding: 2rem;
    }
    textarea, input, select {
      width: 90%;
      background: #1c1c1c;
      color: #00ffee;
      border: 1px solid #00ffee;
      padding: 10px;
      margin-bottom: 1rem;
      border-radius: 6px;
    }
    button {
      background: #00ffee;
      color: #000;
      font-weight: bold;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      margin: 0.3rem;
    }
    .log {
      white-space: pre-wrap;
      text-align: left;
      background: #111;
      padding: 1rem;
      margin-top: 1rem;
      max-height: 300px;
      overflow-y: auto;
      border: 1px solid #00ffee;
      border-radius: 6px;
    }
  </style>
</head>
<body>

<h1>👑 CR Token Control Panel 🔥</h1>

<textarea id="tokensBox" placeholder="توكن في كل سطر..."></textarea><br>
<input id="channelId" placeholder="🆔 Channel ID"><br>
<input id="inviteLink" placeholder="🔗 Discord Invite Link (مثل https://discord.gg/abc123)"><br><br>

<button onclick="startAutoReaction()">🔁 Auto Reaction</button>
<button onclick="startAutoGiveaway()">🎉 Auto Giveaway Join</button>
<button onclick="joinViaInvite()">🔗 Auto Join Server</button>
<button onclick="startSmartReply()">🧠 Smart Auto Reply</button>
<button onclick="stopAuto()">⛔ Stop Auto</button>

<div class="log" id="logBox">📋 السجل سيظهر هنا...</div>

<script>
let autoInterval = null;
let replyIndex = 0;
let smartMessages = ["🔥 خرافي", "😎 تمام", "🤣 حلوة", "👌 Nice", "💀💀"];

function getTokens() {
  return document.getElementById("tokensBox").value.split('\n').map(t => t.trim()).filter(Boolean);
}

function log(msg) {
  const logBox = document.getElementById("logBox");
  logBox.innerText += `\n${new Date().toLocaleTimeString()} | ${msg}`;
  logBox.scrollTop = logBox.scrollHeight;
}

function stopAuto() {
  clearInterval(autoInterval);
  autoInterval = null;
  log("🛑 تم إيقاف جميع المهام التلقائية");
}

// AUTO REACTION
function startAutoReaction() {
  const tokens = getTokens();
  const channelId = document.getElementById('channelId').value.trim();
  if (!channelId) return alert("🛑 اكتب Channel ID");
  clearInterval(autoInterval);
  log("🚀 بدأ Auto Reaction...");
  let lastMessageId = null;

  autoInterval = setInterval(async () => {
    for (const token of tokens) {
      try {
        const res = await fetch(`https://discord.com/api/v10/channels/${channelId}/messages?limit=1`, {
          headers: { Authorization: token }
        });
        const data = await res.json();
        const message = data[0];
        if (message && message.id !== lastMessageId) {
          lastMessageId = message.id;
          await fetch(`https://discord.com/api/v10/channels/${channelId}/messages/${message.id}/reactions/%F0%9F%91%8D/@me`, {
            method: "PUT",
            headers: { Authorization: token }
          });
          log(`👍 React على رسالة ${message.id}`);
        }
      } catch {
        log(`❌ خطأ في Auto Reaction`);
      }
    }
  }, 3000);
}

// AUTO GIVEAWAY
function startAutoGiveaway() {
  const tokens = getTokens();
  const channelId = document.getElementById('channelId').value.trim();
  if (!channelId) return alert("🛑 اكتب Channel ID");
  clearInterval(autoInterval);
  log("🎉 بدأ Auto Giveaway Join...");
  let lastMsg = null;

  autoInterval = setInterval(async () => {
    for (const token of tokens) {
      try {
        const res = await fetch(`https://discord.com/api/v10/channels/${channelId}/messages?limit=1`, {
          headers: { Authorization: token }
        });
        const data = await res.json();
        const msg = data[0];
        if (!msg || msg.id === lastMsg) continue;
        lastMsg = msg.id;

        if (msg.content.includes("🎉") || msg.embeds?.some(e => e.title?.toLowerCase().includes("giveaway"))) {
          await fetch(`https://discord.com/api/v10/channels/${channelId}/messages/${msg.id}/reactions/%F0%9F%8E%89/@me`, {
            method: "PUT",
            headers: { Authorization: token }
          });
          log(`🎉 شارك تلقائي في ${msg.id}`);
        }
      } catch {
        log("⚠️ خطأ في Auto Giveaway Join");
      }
    }
  }, 5000);
}

// AUTO JOIN SERVER
function joinViaInvite() {
  const tokens = getTokens();
  const invite = document.getElementById("inviteLink").value.trim().split("/").pop();
  if (!invite) return alert("🔗 أدخل رابط دعوة صالح!");
  for (const token of tokens) {
    fetch(`https://discord.com/api/v10/invites/${invite}`, {
      method: "POST",
      headers: { Authorization: token }
    }).then(res => {
      if (res.status === 200) {
        log(`✅ ${token.slice(0, 20)}... انضم للسيرفر`);
      } else {
        log(`❌ فشل الانضمام: ${token.slice(0, 20)}...`);
      }
    }).catch(() => {
      log(`❌ فشل الاتصال بـ Discord`);
    });
  }
}

// SMART AUTO REPLY
function startSmartReply() {
  const tokens = getTokens();
  const channelId = document.getElementById("channelId").value.trim();
  if (!channelId) return alert("🆔 اكتب Channel ID");
  clearInterval(autoInterval);
  log("🧠 بدأ Smart Auto Reply...");

  let lastMsg = null;
  autoInterval = setInterval(async () => {
    for (const token of tokens) {
      try {
        const res = await fetch(`https://discord.com/api/v10/channels/${channelId}/messages?limit=1`, {
          headers: { Authorization: token }
        });
        const data = await res.json();
        const msg = data[0];
        if (!msg || msg.id === lastMsg) continue;
        lastMsg = msg.id;
        const reply = smartMessages[replyIndex % smartMessages.length];
        replyIndex++;
        await fetch(`https://discord.com/api/v10/channels/${channelId}/messages`, {
          method: "POST",
          headers: {
            "Authorization": token,
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            content: reply,
            message_reference: { message_id: msg.id }
          })
        });
        log(`💬 رد على ${msg.id}: ${reply}`);
      } catch {
        log(`⚠️ خطأ في Smart Reply`);
      }
    }
  }, 5000);
}
</script>

</body>
</html>
